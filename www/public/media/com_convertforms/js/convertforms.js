jQuery(function(e){e.fn.convertForms=function(){var r=this,t=e.extend({plugin:"ConvertForms",baseurl:"/",debug:!1},ConvertFormsConfig),o={INIT:"Initialized",SUBMIT:"Submitting form",SUBMIT_SUCCESS:"Successful submission",SUBMIT_ERROR:"Submission failed",REDIRECT:"Redirecting to",NO_ELEMENTS:"No elements found on this page. Aborting.",EMPTY_RESPONSE:"Empty Response"};function n(e,r){e.addClass("cf-error"),e.find(".cf-response").html(r),s("Error: "+r)}function s(e){t.debug&&console.log("["+t.plugin+"] "+e)}return function(){if(!r.length)return void s(o.NO_ELEMENTS);s(o.INIT),r.each(function(){var r=e(this);if(r.hasClass("cf-init"))return!0;var i,a=r.find("form");(i=a).on("submit",function(){var r;return r=i,s(o.SUBMIT),box=r.closest(".cf"),button=r.find("button.cf-btn"),e.ajax({type:"POST",url:t.baseurl+"index.php?option=com_ajax&format=raw&plugin=convertforms&task=submit",data:r.serialize(),success:function(t){if(t){try{t=JSON.parse(t)}catch(e){matches=t.match(/{([^}]*)}/i),null!==matches?t=JSON.parse(matches[0]):n(box,e+"<br>"+t)}if(t.success){switch(box.trigger("onSuccess",t),box.trigger("success",t),s(o.SUBMIT_SUCCESS),t.task){case"msg":box.addClass("cf-success"),box.find(".cf-response").html(t.value),"1"==t.resetform&&r[0].reset();break;case"url":url=t.value,"1"==t.passdata&&(url+=(t.value.indexOf("?")>-1?"&":"?")+(i={},r.find("input, select, textarea").filter("[name^=cf]").each(function(){name=e(this).attr("name").match(/cf\[(.*)\]/)[1],value=e(this).val(),i[name]=value}),e.param(i))),s(o.REDIRECT+" "+url),window.location.href=url}box.trigger("afterTask",t)}else box.trigger("onFail",t),box.trigger("fail",t),n(box,t.error),box.find(".cf-fields > .cf-control-group:first .cf-input").focus();var i}else n(box,o.EMPTY_RESPONSE)},error:function(e,r,t){n(box,t)},beforeSend:function(){box.trigger("onBeforeSubmit"),box.trigger("beforeSubmit"),box.addClass("cf-working cf-disabled"),box.removeClass("cf-success cf-error")},complete:function(){e(window).trigger("convertFormsAfterSubmit",box),box.trigger("onAfterSubmit"),box.trigger("afterSubmit"),box.removeClass("cf-working cf-disabled")}}),!1}),r.addClass("cf-init")}),function(){if("undefined"==typeof Inputmask)return;Inputmask("",{jitMasking:!1,showMaskOnHover:!1}).mask(document.querySelectorAll(".cf-input"))}()}(),this},e(window).ready(function(){e(".convertforms").convertForms()})});